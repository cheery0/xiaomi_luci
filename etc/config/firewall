
config defaults
	option syn_flood '0'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'REJECT'
	option drop_invalid '1'
	option disable_ipv6 '1'

config zone
	option name 'lan'
	option network 'lan'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'REJECT'

config zone
	option name 'wan'
	option network 'wan'
	option input 'REJECT'
	option output 'ACCEPT'
	option forward 'REJECT'
	option masq '1'
	option mtu_fix '1'

config forwarding
	option src 'lan'
	option dest 'wan'

config rule
	option name 'Allow-DHCP-Renew'
	option src 'wan'
	option proto 'udp'
	option dest_port '68'
	option target 'ACCEPT'
	option family 'ipv4'

config rule
	option name 'Allow-Ping'
	option src 'wan'
	option proto 'icmp'
	option icmp_type 'echo-request'
	option family 'ipv4'
	option target 'ACCEPT'

config rule
	option name 'Allow-DHCPv6'
	option src 'wan'
	option proto 'udp'
	option src_ip 'fe80::/10'
	option src_port '547'
	option dest_ip 'fe80::/10'
	option dest_port '546'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-ICMPv6-Input'
	option src 'wan'
	option proto 'icmp'
	list icmp_type 'echo-request'
	list icmp_type 'echo-reply'
	list icmp_type 'destination-unreachable'
	list icmp_type 'packet-too-big'
	list icmp_type 'time-exceeded'
	list icmp_type 'bad-header'
	list icmp_type 'unknown-header-type'
	list icmp_type 'router-solicitation'
	list icmp_type 'neighbour-solicitation'
	list icmp_type 'router-advertisement'
	list icmp_type 'neighbour-advertisement'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-ICMPv6-Forward'
	option src 'wan'
	option dest '*'
	option proto 'icmp'
	list icmp_type 'echo-request'
	list icmp_type 'echo-reply'
	list icmp_type 'destination-unreachable'
	list icmp_type 'packet-too-big'
	list icmp_type 'time-exceeded'
	list icmp_type 'bad-header'
	list icmp_type 'unknown-header-type'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'

config include 'wanmonitor'
	option path '/usr/sbin/wan.monitor start'
	option enabled '0'
	option reload '0'

config include 'webinitrdr'
	option path '/lib/firewall.sysapi.loader webinitrdr'
	option reload '1'
	option enabled '1'

config include 'dnsmiwifi'
	option path '/lib/firewall.sysapi.loader dnsmiwifi'
	option reload '1'
	option enabled '1'

config include 'portalfilter'
	option path '/lib/firewall.sysapi.loader portalfilter'
	option reload '1'
	option enabled '1'

config include 'macfilter'
	option path '/lib/firewall.sysapi.loader macfilter'
	option reload '1'
	option enabled '1'

config include 'miqos'
	option path '/lib/firewall.sysapi.loader miqos'
	option reload '1'

config include 'firewalluser'
	option path '/etc/firewall.user'
	option reload '1'

config include 'dmz_bypass_ctf'
	option path '/lib/firewall.sysapi.loader dmz_bypass_ctf'
	option reload '1'

config rule 'xunleiwantcpports'
	option name 'xunlei wan accept tcp port 1080 4662 2080 2062'
	option src 'wan'
	option dest_port '1080 4662 2080 2062'
	option proto 'tcp'
	option target 'ACCEPT'

config rule 'xunleiwanudpports'
	option name 'xunlei wan accept udp port 4661 3027 888 666 2037 2061 2048 2066'
	option src 'wan'
	option dest_port '4661 3027 888 666 2037 2061 2048 2066'
	option proto 'udp'
	option target 'ACCEPT'

config rule 'shuijingwantcpports'
	option name 'shuijing wan accept tcp port 4593'
	option src 'wan'
	option dest_port '4593'
	option proto 'tcp'
	option target 'ACCEPT'

config rule 'shuijingwanudpports'
	option name 'shuijing wan accept udp port 4693'
	option src 'wan'
	option dest_port '4693'
	option proto 'udp'
	option target 'ACCEPT'

config rule 'guest_8999'
	option name 'Hello wifi 8999'
	option src 'guest'
	option proto 'tcp'
	option dest_port '8999'
	option target 'ACCEPT'

config rule 'guest_8300'
	option name 'Hello wifi 8300'
	option src 'guest'
	option proto 'tcp'
	option dest_port '8300'
	option target 'ACCEPT'

config rule 'guest_7080'
	option name 'Hello wifi 7080'
	option src 'guest'
	option proto 'tcp'
	option dest_port '7080'
	option target 'ACCEPT'

config include 'rr_rule'
	option path '/lib/firewall/rr.load reload'
	option reload '1'

config rule 'ready_dhcp'
	option src_port '67-68'
	option name 'DHCP for ready'
	option proto 'udp'
	option target 'ACCEPT'
	option dest_port '67-68'
	option src 'ready'

config rule 'ready_dhcp_out'
	option src_port '67-68'
	option name 'DHCP for ready'
	option target 'ACCEPT'
	option dest 'ready'
	option proto 'udp'
	option dest_port '67-68'

config rule 'ready_tbus_in'
	option dest_port '784'
	option name 'tbus for ready'
	option target 'ACCEPT'
	option proto 'tcp'
	option src 'ready'

config rule 'ready_tbus_out'
	option src_port '784'
	option name 'tbus for ready'
	option target 'ACCEPT'
	option proto 'tcp'
	option src 'ready'

config zone 'ready_zone'
	option output 'DROP'
	option name 'ready'
	option input 'DROP'
	option forward 'DROP'

config redirect 'nxdomain'
	option src_dport '80'
	option dest_port '8190'
	option name 'nxdomain'
	option target 'DNAT'
	option src_dip '198.51.100.9'
	option proto 'tcp'
	option src 'lan'

config include 'xqfp'
	option path '/lib/firewall.sysapi.loader xqfp'
	option reload '1'

config forwarding 'guest_forward'
	option src 'guest'
	option dest 'wan'

config zone 'guest_zone'
	option name 'guest'
	option network 'guest'
	option input 'REJECT'
	option forward 'REJECT'
	option output 'ACCEPT'

config rule 'guest_dns'
	option src 'guest'
	option dest_port '53'
	option proto 'tcpudp'
	option target 'ACCEPT'

config rule 'guest_dhcp'
	option src 'guest'
	option src_port '67-68'
	option dest_port '67-68'
	option proto 'udp'
	option target 'ACCEPT'

config include 'wifishare'
	option path '/usr/sbin/wifishare.sh reload'
	option reload '1'

config include 'miniupnpd'
	option type 'script'
	option path '/usr/share/miniupnpd/firewall.include'
	option family 'IPv4'
	option reload '1'

